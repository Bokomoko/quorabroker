(window.ansFrontendRelayWebpackJsonpFunction=window.ansFrontendRelayWebpackJsonpFunction||[]).push([["component-NUXRenderer"],{"4GQf":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return k})),n.d(t,"f",(function(){return y}));var a,l=n("J4zp"),r=n.n(l),s=n("SKAY"),i=n("KP5v"),o=n("AaDK"),u=n("qy3/"),d=n("q1tI");const c="760px",p="550px",m={follow_interests:"FollowInterestsStep",language:"LanguageStep",download_app:"DownloadAppStep",spinner:"SpinnerStep"},g=[["index","index"],["question","q"],["question","answer"],["topic","t"]],f=()=>!!(()=>{let e=!1;for(const n of g){var t=r()(n,2);const a=t[0],l=t[1];a===Object(s.getSetting)("controller")&&l===Object(s.getSetting)("action")&&(e=!0)}return e})()&&!Object(s.getSetting)("getParams").digest_story,h=e=>Object(u.c)(e)&&f(),b=e=>{let t=e.openModalFlow;return Object(d.useEffect)(()=>{Object(o.a)("nux_start",{}),t()},[t]),null},k=void 0!==a?a:a=n("tDOW"),y=()=>Boolean(Object(i.a)("nux_ux_update"))},SpgY:function(e,t,n){"use strict";n.r(t),n.d(t,"nuxTransition",(function(){return _}));var a,l=n("eP4p"),r=n("4GQf"),s=n("EFAP"),i=n("jQ0q"),o=n("SKAY"),u=n("8lmh"),d=n("VyO/"),c=n("AaDK"),p=n("nwxp"),m=n("GLuq"),g=n("mF64"),f=n("UyMh"),h=n("q1tI"),b=n.n(h),k=n("RqIh"),y=n("jufJ"),x=n("noLW"),w=n("6lcX"),S=n("RA+f"),O=n("d1zJ");class v extends h.Component{constructor(e){super(e),this.state={currentStepIdx:0}}incrementStepIdx(){this.setState(e=>Object.assign({},e,{currentStepIdx:e.currentStepIdx+1}))}render(){const e=this.props.totalSteps,t=this.state.currentStepIdx,n=(this.state.currentStepIdx+1)/e*100+"%";return t<e&&b.a.createElement(S.i,{top:0,fullX:!0,zIndex:"modal_desktop",bg:"white",borderBottom:!0,boxShadow:"medium"},b.a.createElement(S.j,{width:w.d,mx:"auto",alignItems:"center",justifyContent:"space-between"},b.a.createElement(x.a,{color:"red",height:O.b}),b.a.createElement(S.n,{alignItems:"center"},b.a.createElement(S.e,null,b.a.createElement(S.s,{medium:!0},b.a.createElement(y.Translate,null,"Start"))),b.a.createElement(S.e,{px:"medium"},b.a.createElement(S.e,{bg:"gray",borderRadius:"pill",height:10,width:600},b.a.createElement(S.e,{bg:"blue",borderRadius:"pill",height:"100%",width:n,transition:"width",transitionDuration:"400ms"}))),b.a.createElement(S.e,null,b.a.createElement(S.s,{medium:!0},b.a.createElement(y.Translate,null,"Finish")))),b.a.createElement(S.e,{opacity:0},b.a.createElement(x.a,{color:"red",height:O.b}))))}}const F=e=>{const t=Object(r.f)();return{name:r.g[e],queryVariables:{stepType:e},desktopWidth:t?"100vw":r.b,desktopHeight:t?"100vh":r.a,desktopOverlayStyle:{backgroundColor:"white"}}},_=e=>{var t;let n=e.flowData,a=e.showNextModal,l=e.dismissModalFlow;const s=n.stepNames[n.stepIdx];if(Object(c.a)("nux_step_completion",{step_name:s}),n.stepIdx+=1,null!==(t=n.headerRef)&&void 0!==t&&t.current&&n.headerRef.current.incrementStepIdx(),n.stepIdx>=n.stepNames.length)l();else{n.isLastStep=n.stepIdx>=n.numInteractiveSteps-1;const e=Object(r.f)();a({modalProps:{name:r.g[n.stepNames[n.stepIdx]],queryVariables:{stepType:n.stepNames[n.stepIdx]},desktopWidth:e?"100vw":r.b,desktopHeight:e?"100vh":r.a,desktopOverlayStyle:{backgroundColor:"white"}},replaceActiveModal:!0})}};class j extends b.a.Component{constructor(e){super(e),this.headerRef=void 0,this.shouldIncludeSpinnerStep=e=>o.isStorybook||o.isNpmRunStart||[k.a.answer,k.a.home_feed_main].includes(e),this.headerRef=b.a.createRef()}render(){const e=this.props.nux;if(!e)return null;if(!Object(r.e)(e.steps))return null;const t=e.steps.length,n=e.id,a=e.__typename,c=Object(r.f)();return b.a.createElement(s.d.Consumer,null,s=>{const h=!!s&&this.shouldIncludeSpinnerStep(s);return b.a.createElement(d.a,{mutation:j.mutations.nuxMarkComplete,variables:{},onCompleted:()=>{const e=Object(o.getSetting)("pageOid");if(Object(p.h)())Object(l.h)();else if(s!==k.a.answer||e||(Object(u.logJsError)("NUXRenderer",`Answer page doesn't have aid, given context:${e} URL: ${Object(g.b)().href}`),Object(f.c)(Object(m.g)("/"))),s===k.a.answer&&Object(f.c)("/?signup_answer_page="+e,"replace"),s===k.a.question_main){const e=Object(m.d)("/");e.query.from_signup=1,Object(f.c)(e)}},optimisticResponse:{nuxMarkComplete:{nux:{id:n,__typename:a,steps:[]},viewer:{showGoToFeedGrowl:!0}}}},n=>b.a.createElement(b.a.Fragment,null,Object(p.c)()&&!c&&b.a.createElement(v,{totalSteps:t+1,ref:this.headerRef}),b.a.createElement(i.a,{shouldPrefetch:Object(p.h)(),modalFlowProps:{initialModalProps:F(e.steps[0].name),initialFlowData:{stepIdx:0,numInteractiveSteps:t,stepNames:[...e.steps.map(e=>e.name),...h?["spinner"]:[]],isLastStep:t<2,headerRef:this.headerRef,pageType:s},containerProps:{legacy:!0,easyDismissEnabled:!1,desktopBorderAll:!c&&undefined,desktopBorderRadius:c?0:undefined,desktopMaxWidth:c?"100vw":undefined,desktopMaxHeight:c?"100vh":undefined},dismissableBack:!1,transitionName:"NUXTransition",postDismissCallback:n}},e=>{let t=e.openModalFlow;return b.a.createElement(r.c,{openModalFlow:t})})))})}}j.fragments={nux:void 0!==a?a:a=n("v5H7")},j.mutations={nuxMarkComplete:r.d},j.displayName="NUXRenderer";t["default"]=Object(d.b)(j)},tDOW:function(e,t,n){"use strict";n.r(t);var a=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,concreteType:"NUX",kind:"LinkedField",name:"nux",plural:!1,selections:[e,t,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"steps",plural:!0,selections:[e,t],storageKey:null}],storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"showGoToFeedGrowl",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"utils_nuxMarkComplete_Mutation",selections:[{alias:null,args:null,concreteType:"NuxMarkComplete",kind:"LinkedField",name:"nuxMarkComplete",plural:!1,selections:[n,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[a],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"utils_nuxMarkComplete_Mutation",selections:[{alias:null,args:null,concreteType:"NuxMarkComplete",kind:"LinkedField",name:"nuxMarkComplete",plural:!1,selections:[n,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,e],storageKey:null}],storageKey:null}]},params:{id:"2d92443ab0f3df586c10bf163ec9e28e93661c21037e42c5a079fdbd0e66ff8e",metadata:{},name:"utils_nuxMarkComplete_Mutation",operationKind:"mutation",text:null}}}();a.hash="39f16cccc7d9e08a9ab0e43fa19d546e",t["default"]=a},v5H7:function(e,t,n){"use strict";n.r(t);var a=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"NUXRenderer_nux",selections:[e,t,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"steps",plural:!0,selections:[e,t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"NUX",abstractKey:null}}();a.hash="8c29d0d10ed3a46bd9362f6188158a5b",t["default"]=a}}]);